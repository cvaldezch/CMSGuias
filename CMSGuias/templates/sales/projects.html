{% extends "base.html" %}
{% block title %}
    List Projects
{% endblock title %}
{% block script %}
<script src="{{ MEDIA_URL }}js/tinymce.js"></script>
<script src="{{ MEDIA_URL }}js/mustache.js"></script>
<script src="{{ MEDIA_URL }}js/getCountry.js"></script>
<script src="{{ MEDIA_URL }}js/sales/projects.js"></script>
<script src="{{ MEDIA_URL }}js/floatThead.js"></script>
{% endblock script %}
{% block menu %}
    {% if user.get_profile.empdni.charge.area|lower == 'administrator' or user.get_profile.empdni.charge.area|lower == 'ventas' %}
        {% include "menus/sale.htm" %}
    {% endif %}
    {% if user.get_profile.empdni.charge.area|lower == 'operaciones' %}
        {% include "menus/operations.htm" %}
    {% endif %}
    {% if user.get_profile.empdni.charge.area|lower == 'logistica' %}
        {% include "menus/logistics.htm" %}
    {% endif %}
    {% if user.get_profile.empdni.charge.area|lower == 'almacen' %}
        {% include "menus/storage_menu.htm" %}
    {% endif %}
{% endblock menu %}
{% block content %}
<div class="container">
    <div class="well">
        <header>
            <h3>Proyectos</h3>
        </header>
        <aside>
        {% if user.get_profile.empdni.charge.area|lower == 'administrator' or user.get_profile.empdni.charge.area|lower == 'ventas' %}
            <div class="btn-group">
                <button class="btn btn-primary btn-add">
                    <span class="glyphicon glyphicon-plus"></span>
                    <span> Nuevo Proyecto</span>
                </button>
                <button class="btn btn-success text-black btn-save">
                    <span class="glyphicon glyphicon-floppy-disk"></span> Guardar Cambios
                </button>
            </div>
            <div class="panel panel-primary panel-pro">
                <div class="panel-body">
                    <div class="row">
                        {% csrf_token %}
                        <div class="col-md-4">
                            <div class="form-group has-primary">
                                <label class="control-label">Cliente</label>
                                <div class="input-group input-group-sm">
                                    <select name="ruccliente" id="ruccliente" class="form-control input-sm">
                                        {% for x in customers %}
                                            <option value="{{ x.ruccliente_id }}">{{ x.razonsocial }}</option>
                                        {% empty %}
                                            <option value="">-- Nothing --</option>
                                        {% endfor %}
                                    </select>
                                    <span class="input-group-btn">
                                        <button class="btn btn-primary btn-sm btn-add-customers"><span class="glyphicon glyphicon-plus"></span></button>
                                        <button class="btn btn-primary btn-sm"><span class="glyphicon glyphicon-refresh"></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="form-group has-primary">
                                <label class="control-label">Nombre Proyecto</label>
                                <input type="text" name="nompro" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Inicio Proyecto</label>
                                <input type="text" name="comienzo" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Fin Proyecto</label>
                                <input type="text" name="fin" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Pais</label>
                                <div class="input-group input-group-sm">
                                    <select name="pais" id="pais" class="form-control input-sm">
                                        {% for x in country %}
                                            <option value="{{ x.pais_id }}">{{ x.paisnom }}</option>
                                        {% endfor %}
                                    </select>
                                    <span class="input-group-btn">
                                        <button class="btn btn-primary btn-sm btn-add-country"><span class="glyphicon glyphicon-plus"></span></button>
                                        <button class="btn btn-primary btn-country-refresh btn-sm"><span class="glyphicon glyphicon-refresh"></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Depatamento</label>
                                <div class="input-group">
                                    <select name="departamento" id="" class="form-control input-sm"></select>
                                    <span class="input-group-btn">
                                        <button class="btn btn-primary btn-sm btn-add-departament"><span class="glyphicon glyphicon-plus"></span></button>
                                        <button class="btn btn-primary btn-departament-refresh btn-sm"><span class="glyphicon glyphicon-refresh"></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Provincia</label>
                                <div class="input-group input-group-sm">
                                    <select name="provincia" id="provincia" class="form-control input-sm"></select>
                                     <span class="input-group-btn">
                                        <button class="btn btn-primary btn-sm btn-add-province"><span class="glyphicon glyphicon-plus"></span></button>
                                        <button class="btn btn-primary btn-province-refresh btn-sm"><span class="glyphicon glyphicon-refresh"></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Distrito</label>
                                <div class="input-group input-group-sm">
                                    <select name="distrito" id="" class="form-control input-sm"></select>
                                     <span class="input-group-btn">
                                        <button class="btn btn-primary btn-sm btn-add-district"><span class="glyphicon glyphicon-plus"></span></button>
                                        <button class="btn btn-primary btn-district-refresh btn-sm"><span class="glyphicon glyphicon-refresh"></span></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group has-primary">
                                <label class="control-label">Dirección</label>
                                <input type="text" name="direccion" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group has-primary">
                                <label class="control-label">Moneda</label>
                                <select name="currency" class="form-control input-sm">
                                {% for x in currency %}
                                    <option value="{{ x.moneda_id }}">{{ x.moneda }}</option>
                                {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group has-primary">
                                <label class="control-label">Tipo de Proyecto</label>
                                <select name="typep" class="form-control input-sm">
                                    {% for k, v in typep.iteritems %}
                                        <option value="{{ k }}">{{ v }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="form-group has-primary">
                                <label class="control-label">Tipo Cambio</label>
                                <input type="text" name="exchange" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-5">
                            <div class="form-group has-primary">
                                <label class="control-label">Contacto de Proyecto</label>
                                <input type="text" name="contact" class="form-control input-sm">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group has-primary">
                                <label class="control-label">Observación</label>
                                <textarea name="obser" id="obser" rows="5" class="form-control input-sm"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
        </aside>
        <article>
            {#% if request.user.get_profile.empdni.charge.area|lower == '' %#}
                <!--  -->
            {#% endif %#}
        </article>
        <div class="panel panel-default">
            <div class="panel-heading text-right">
                <button class="btn btn-sm btn-link text-black btn-show-group">
                    <span class="fa fa-reorder fa-lg"></span>
                </button>
                <button class="btn btn-sm btn-link text-black btn-show-table">
                    <span class="fa fa-list-alt fa-lg"></span>
                </button>
            </div>
            {% if request.user.get_profile.empdni.charge.area|lower == 'operaciones' %}
                <div class="panel panel-success">
                  <div class="table-responsive">
                    <table class="table table-hover table-condensed">
                      <thead>
                          <tr class="brand-danger text-white">
                              <th class="text-center">Item</th>
                              <th></th>
                              <th class="text-center">Codigo</th>
                              <th>Nombre de Proyecto</th>
                              <th>Contacto</th>
                              <th class="text-center col-2">Registrado</th>
                              <th class="text-center col-2">Fecha Inicio</th>
                              <th class="text-center col-2">Fecha Fin</th>
                              <!-- <th>Progreso</th> -->
                              {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                <th class="text-center">Editar</th>
                                <th class="text-center">Eliminar</th>
                              {% endif %}
                          </tr>
                      </thead>
                      <tbody>
                          {% for x in list %}
                              <!-- {% if x.itemsPercent != '100.0' %}
                                  {% if x.is_out_date %}
                                      <tr class="tr-{{ x.proyecto_id }} danger">
                                  {% else %}
                                      {% ifequal x.status 'AC' %}
                                          <tr class="tr-{{ x.proyecto_id }} warning">
                                      {% endifequal %}
                                      {% ifequal x.status 'PE' %}
                                          <tr class="tr-{{ x.proyecto_id }}">
                                      {% endifequal %}
                                  {% endif %}
                              {% else %}
                                  {% ifequal x.status 'AC' %}
                                    <tr class="tr-{{ x.proyecto_id }} warning">
                                  {% endifequal %}
                                  {% ifequal x.status 'PE' %}
                                    <tr class="tr-{{ x.proyecto_id }}">
                                  {% endifequal %}
                              {% endif %} -->
                              {% if x.is_out_date %}
                                <tr class="tr-{{ x.proyecto_id }} danger">
                              {% else %}
                                {% ifequal x.status 'AC' %}
                                  <tr class="tr-{{ x.proyecto_id }} warning">
                                {% endifequal %}
                                {% ifequal x.status 'PE' %}
                                  <tr class="tr-{{ x.proyecto_id }}">
                                {% endifequal %}
                              {% endif %}
                                  <td>{{ forloop.counter }}</td>
                                  <td>
                                      <a href="{% url 'managerpro_view' x.proyecto_id %}" class="btn btn-link btn-xs btn-open text-black">
                                          <span class="fa fa-fire-extinguisher"></span>
                                          <span class="glyphicon glyphicon-fire"></span>
                                      </a>
                                  </td>
                                  <td>{{ x.proyecto_id }}</td>
                                  <td>{{ x.nompro }}</td>
                                  <td>{{ x.contact }}</td>
                                  <td class="text-center">{{ x.registrado|date:"Y-m-d" }}</td>
                                  <td>{{ x.comienzo|date:"Y-m-d" }}</td>
                                  <td>{{ x.fin|date:"Y-m-d" }}</td>
                                  <!-- <td>
                                      <div class="progress">
                                          <div class="progress-bar
                                          {#% if x.itemsPercent == '100.0' %#}
                                              progress-bar-success
                                          {#% else %#}
                                              progress-bar-warning
                                          {#% endif %#}
                                           text-black" role="progressbar" aria-valuenow="{#{ x.itemsPercent }#}" aria-valuemin="0" aria-valuemax="100" style="width: {#{ x.itemsPercent }#}%;">
                                              {{ x.itemsPercent }}%
                                          </div>
                                      </div>
                                  </td> -->
                                  {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                  <td class="text-center">
                                      <button class="btn btn-link btn-xs text-black btn-show-edit" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-edit"></span>
                                      </button>
                                  </td>
                                  <td class="text-center">
                                      <button type="Button" class="btn btn-xs btn-link text-red btn-show-delete" title="{{ x.nompro }}" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-trash"></span>
                                      </button>
                                  </td>
                                  {% endif %}
                              </tr>
                          {% empty %}
                              <div class="alert alert-warning">
                                  <strong>Warning</strong>
                                  <p>No se han encontrado <q><strong>Proyectos</strong></q> para mostrar. Presione el botón <q><strong>Nuevo Proyecto</strong></q> para agregar.<p>
                              </div>
                          {% endfor%}
                      </tbody>
                    </table>
                  </div>
                </div>
            {% else %}
                <div class="panel-group panel-first" id="accordion" role="tablist" aria-multiselectable="true">
                    {% for c in cust %}
                        <div class="panel panel-danger">
                            <div class="panel-heading" role="tab" id="headingOne">
                                <h4 class="panel-title">
                                    <a data-toggle="collapse" data-value="{{ c.ruccliente_id }}" data-parent="#accordion" href="#{{ c.ruccliente_id }}" aria-expanded="true" aria-controls="{{ c.ruccliente_id }}">
                                        {{ c.ruccliente.razonsocial }}
                                    </a>
                                </h4>
                            </div>
                            <div id="{{ c.ruccliente_id }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                                <div class="table-responsive">
                                    <table class="table table-hover table-condensed table-{{ c.ruccliente_id }}">
                                        <thead>
                                            <tr class="brand-danger text-white">
                                                <th class="text-center">Item</th>
                                                <th></th>
                                                <th class="text-center">Codigo</th>
                                                <th>Nombre de Proyecto</th>
                                                <th>Contacto</th>
                                                <th class="text-center col-2">Registrado</th>
                                                <th class="text-center col-2">Fecha Inicio</th>
                                                <th class="text-center col-2">Fecha Fin</th>
                                                <!-- <th class="text=center">Progreso</th> -->
                                                {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                                  <th class="text-center">Editar</th>
                                                  <th class="text-center">Eliminar</th>
                                                {% endif %}
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {% for x in list %}
                                                {% if x.ruccliente_id == c.ruccliente_id %}
                                                    <!-- {% if x.itemsPercent != '100.0' %}
                                                        {% if x.is_out_date %}
                                                            <tr class="tr-{{ x.proyecto_id }} danger">
                                                        {% else %}
                                                            {% ifequal x.status 'AC' %}
                                                                <tr class="tr-{{ x.proyecto_id }} warning">
                                                            {% endifequal %}
                                                            {% ifequal x.status 'PE' %}
                                                                <tr class="tr-{{ x.proyecto_id }}">
                                                            {% endifequal %}
                                                        {% endif %}
                                                    {% else %}
                                                         {% ifequal x.status 'AC' %}
                                                                <tr class="tr-{{ x.proyecto_id }} warning">
                                                            {% endifequal %}
                                                            {% ifequal x.status 'PE' %}
                                                                <tr class="tr-{{ x.proyecto_id }}">
                                                            {% endifequal %}
                                                    {% endif %} -->
                                                    {% if x.is_out_date %}
                                                      <tr class="tr-{{ x.proyecto_id }} danger">
                                                    {% else %}
                                                      {% ifequal x.status 'AC' %}
                                                        <tr class="tr-{{ x.proyecto_id }} warning">
                                                      {% endifequal %}
                                                      {% ifequal x.status 'PE' %}
                                                        <tr class="tr-{{ x.proyecto_id }}">
                                                      {% endifequal %}
                                                    {% endif %}
                                                        <td>{{ forloop.counter }}</td>
                                                        <td>
                                                            <a href="{% url 'managerpro_view' x.proyecto_id %}" class="btn btn-link btn-xs btn-open text-black">
                                                                <span class="fa fa-fire-extinguisher"></span>
                                                                <span class="glyphicon glyphicon-fire"></span>
                                                            </a>
                                                        </td>
                                                        <td>{{ x.proyecto_id }}</td>
                                                        <td>{{ x.nompro }}</td>
                                                        <td>{{ x.contact }}</td>
                                                        <td class="text-center">{{ x.registrado|date:"Y-m-d" }}</td>
                                                        <td>{{ x.comienzo|date:"Y-m-d" }}</td>
                                                        <td>{{ x.fin|date:"Y-m-d" }}</td>
                                                        <!-- <td>
                                                            <div class="progress">
                                                                <div class="progress-bar
                                                                {#% if x.itemsPercent == '100.0' %#}
                                                                    progress-bar-success
                                                                {#% else %#}
                                                                    progress-bar-warning
                                                                {#% endif %#}
                                                                 text-black" role="progressbar" aria-valuenow="{#{ x.itemsPercent }#}" aria-valuemin="0" aria-valuemax="100" style="width: {#{ x.itemsPercent }#}%;">
                                                                    {#{ x.itemsPercent }#}%
                                                                </div>
                                                            </div>
                                                        </td> -->
                                                        {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                                        <td class="text-center">
                                                            <button class="btn btn-link btn-xs text-black btn-show-edit" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-edit"></span>
                                                            </button>
                                                        </td>
                                                        <td class="text-center">
                                                            <button type="Button" class="btn btn-xs btn-link text-red btn-show-delete" title="{{ x.nompro }}" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-trash"></span>
                                                            </button>
                                                        </td>
                                                        {% endif %}
                                                    </tr>
                                                {% endif %}
                                            {% empty %}
                                                <div class="alert alert-warning">
                                                    <strong>Warning</strong>
                                                    <p>No se han encontrado <q><strong>Proyectos</strong></q> para mostrar. Presione el botón <q><strong>Nuevo Proyecto</strong></q> para agregar.<p>
                                                </div>
                                            {% endfor%}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
                <div class="panel panel-success panel-second">
                    <div class="table-responsive">
                        <table class="table table-hover table-condensed">
                            <thead>
                                <tr class="brand-danger text-white">
                                    <th class="text-center">Item</th>
                                    <th></th>
                                    <th class="text-center">Codigo</th>
                                    <th>Nombre de Proyecto</th>
                                    <th>Contacto</th>
                                    <th class="text-center col-3">Registrado</th>
                                    <th class="text-center col-3">Fecha Inicio</th>
                                    <th class="text-center col-3">Fecha Fin</th>
                                    <!-- <th>Progreso</th> -->
                                    {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                    <th class="text-center">Editar</th>
                                    <th class="text-center">Eliminar</th>
                                    {% endif %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for x in list %}
                                    <!-- {% if x.itemsPercent != '100.0' %}
                                        {% if x.is_out_date %}
                                            <tr class="tr-{{ x.proyecto_id }} danger">
                                        {% else %}
                                            {% ifequal x.status 'AC' %}
                                                <tr class="tr-{{ x.proyecto_id }} warning">
                                            {% endifequal %}
                                            {% ifequal x.status 'PE' %}
                                                <tr class="tr-{{ x.proyecto_id }}">
                                            {% endifequal %}
                                        {% endif %}
                                    {% else %}
                                         {% ifequal x.status 'AC' %}
                                                <tr class="tr-{{ x.proyecto_id }} warning">
                                            {% endifequal %}
                                            {% ifequal x.status 'PE' %}
                                                <tr class="tr-{{ x.proyecto_id }}">
                                            {% endifequal %}
                                    {% endif %} -->
                                    {% if x.is_out_date %}
                                      <tr class="tr-{{ x.proyecto_id }} danger">
                                    {% else %}
                                      {% ifequal x.status 'AC' %}
                                        <tr class="tr-{{ x.proyecto_id }} warning">
                                      {% endifequal %}
                                      {% ifequal x.status 'PE' %}
                                        <tr class="tr-{{ x.proyecto_id }}">
                                      {% endifequal %}
                                    {% endif %}
                                        <td>{{ forloop.counter }}</td>
                                        <td>
                                            <a href="{% url 'managerpro_view' x.proyecto_id %}" class="btn btn-link btn-xs btn-open text-black">
                                                <span class="fa fa-fire-extinguisher"></span>
                                                <span class="glyphicon glyphicon-fire"></span>
                                            </a>
                                        </td>
                                        <td>{{ x.proyecto_id }}</td>
                                        <td>{{ x.nompro }}</td>
                                        <td>{{ x.contact }}</td>
                                        <td class="text-center">{{ x.registrado|date:"Y-m-d" }}</td>
                                        <td>{{ x.comienzo|date:"Y-m-d" }}</td>
                                        <td>{{ x.fin|date:"Y-m-d" }}</td>
                                        <!-- <td>
                                            <div class="progress">
                                                <div class="progress-bar
                                                {% if x.itemsPercent == '100.0' %}
                                                    progress-bar-success
                                                {% else %}
                                                    progress-bar-warning
                                                {% endif %}
                                                 text-black" role="progressbar" aria-valuenow="{{ x.itemsPercent }}" aria-valuemin="0" aria-valuemax="100" style="width: {{ x.itemsPercent }}%;">
                                                    {{ x.itemsPercent }}%
                                                </div>
                                            </div>
                                        </td> -->
                                        {% if user.get_profile.empdni.charge.area|lower == "administrator" or user.get_profile.empdni.charge.area|lower == "ventas"  %}
                                        <td class="text-center">
                                            <button class="btn btn-link btn-xs text-black btn-show-edit" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-edit"></span>
                                            </button>
                                        </td>
                                        <td class="text-center">
                                            <button type="Button" class="btn btn-xs btn-link text-red btn-show-delete" title="{{ x.nompro }}" value="{{ x.proyecto_id }}"><span class="glyphicon glyphicon-trash"></span>
                                            </button>
                                        </td>
                                        {% endif %}
                                    </tr>
                                {% empty %}
                                    <div class="alert alert-warning">
                                        <strong>Warning</strong>
                                        <p>No se han encontrado <q><strong>Proyectos</strong></q> para mostrar. Presione el botón <q><strong>Nuevo Proyecto</strong></q> para agregar.<p>
                                    </div>
                                {% endfor%}
                            </tbody>
                        </table>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock content %}
